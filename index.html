<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>H&L WorkFlow Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script async defer src="https://apis.google.com/js/api.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <style>
    body { background: radial-gradient(circle at top left, #0f172a 0, #020617 45%, #020617 100%); color: #e5e7eb; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }
    .glass-panel { background: rgba(15, 23, 42, 0.85); border-radius: 1rem; border: 1px solid rgba(148, 163, 184, 0.2); box-shadow: 0 10px 15px -3px rgba(15, 23, 42, 0.5), 0 4px 6px -4px rgba(15, 23, 42, 0.8); backdrop-filter: blur(16px); }
    .stat-card { background: linear-gradient(135deg, rgba(15, 23, 42, 0.95), rgba(30, 64, 175, 0.65)); }
    .badge { border-radius: 9999px; padding: 0.15rem 0.6rem; font-size: 0.7rem; font-weight: 600; letter-spacing: 0.05em; text-transform: uppercase; }
    .badge-peacock { background: rgba(34, 197, 94, 0.12); color: #4ade80; border: 1px solid rgba(74, 222, 128, 0.4); }
    .badge-tomato { background: rgba(248, 113, 113, 0.12); color: #fb7185; border: 1px solid rgba(248, 113, 113, 0.4); }
    .badge-blue { background: rgba(37, 99, 235, 0.12); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.5); }
    .badge-red { background: rgba(239, 68, 68, 0.12); color: #fca5a5; border: 1px solid rgba(239, 68, 68, 0.5); }
    .scrollbar-thin::-webkit-scrollbar { width: 6px; }
    .scrollbar-thin::-webkit-scrollbar-track { background: transparent; }
    .scrollbar-thin::-webkit-scrollbar-thumb { background-color: rgba(148, 163, 184, 0.5); border-radius: 9999px; }
    .activity-pill { border-radius: 9999px; padding: 0.35rem 0.75rem; font-size: 0.75rem; display: inline-flex; align-items: center; gap: 0.35rem; }
    .btn-primary { background: linear-gradient(135deg, #22c55e, #16a34a); }
    .btn-primary:hover { background: linear-gradient(135deg, #4ade80, #16a34a); }
    .btn-secondary { background: rgba(15, 23, 42, 0.95); }
    .btn-secondary:hover { background: rgba(30, 64, 175, 0.9); }
    .stat-number { font-variant-numeric: tabular-nums; }
  </style>
</head>
<body class="min-h-screen">
  <div class="max-w-7xl mx-auto px-4 py-6 lg:py-8">
    <header class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">
      <div>
        <h1 class="text-2xl md:text-3xl font-bold text-white flex items-center gap-3">
          <span class="inline-flex items-center justify-center w-10 h-10 rounded-2xl bg-emerald-500/20 text-emerald-300 border border-emerald-400/40"><i class="fa-solid fa-stethoscope"></i></span>
          H&L WorkFlow Dashboard
        </h1>
        <p class="text-slate-400 text-sm md:text-base mt-1">Unified command centre for Doctors' Pay Calculator, projects, alerts and team coordination.</p>
      </div>
      <div class="flex items-center gap-3">
        <span id="last-refreshed" class="text-xs text-slate-400 hidden sm:inline-block">Last updated: <span id="last-refresh-time">never</span></span>
        <button id="refreshBtn" class="inline-flex items-center gap-2 px-3 py-2 rounded-xl text-xs font-medium text-slate-100 border border-emerald-400/40 bg-slate-900/70 hover:bg-slate-900 transition"><i class="fa-solid fa-rotate-right"></i> Refresh</button>
        <button id="settingsBtn" class="inline-flex items-center gap-2 px-3 py-2 rounded-xl text-xs font-medium text-slate-100 border border-slate-600/60 bg-slate-900/80 hover:bg-slate-800 transition"><i class="fa-solid fa-gear"></i> Settings</button>
      </div>
    </header>
    <main class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <section class="lg:col-span-2 space-y-6">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div class="glass-panel stat-card p-4"><div class="flex items-center justify-between mb-1"><span class="text-xs font-semibold text-slate-300 uppercase tracking-wide">Active Tasks</span><span class="badge badge-blue">Wrike</span></div><p id="activeTasks" class="text-2xl md:text-3xl font-bold text-white stat-number">0</p><p class="text-xs text-slate-400 mt-1">Across all live projects</p></div>
          <div class="glass-panel stat-card p-4"><div class="flex items-center justify-between mb-1"><span class="text-xs font-semibold text-slate-300 uppercase tracking-wide">Upcoming Events</span><span class="badge badge-peacock">Calendar</span></div><p id="upcomingEvents" class="text-2xl md:text-3xl font-bold text-white stat-number">0</p><p class="text-xs text-slate-400 mt-1">Next 7 days</p></div>
          <div class="glass-panel stat-card p-4"><div class="flex items-center justify-between mb-1"><span class="text-xs font-semibold text-slate-300 uppercase tracking-wide">Completed</span><span class="badge badge-tomato">Velocity</span></div><p id="percentComplete" class="text-2xl md:text-3xl font-bold text-white stat-number">0%</p><p class="text-xs text-slate-400 mt-1">Tasks completed this week</p></div>
          <div class="glass-panel stat-card p-4"><div class="flex items-center justify-between mb-1"><span class="text-xs font-semibold text-slate-300 uppercase tracking-wide">Team Members</span><span class="badge badge-peacock">H&L</span></div><p id="teamMembers" class="text-2xl md:text-3xl font-bold text-white stat-number">2</p><p class="text-xs text-slate-400 mt-1">Core workflow owners</p></div>
        </div><div class="glass-panel p-4 flex flex-wrap gap-3 items-center"><div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-emerald-400 animate-pulse"></span><span class="text-xs text-slate-300 font-medium uppercase tracking-wide">Alert Badges</span></div><div class="flex flex-wrap gap-2 text-xs"><span class="badge badge-peacock flex items-center gap-1">ğŸ¦š PEACOCK: <span id="peacockCount" class="font-mono">0</span></span><span class="badge badge-tomato flex items-center gap-1">ğŸ… TOMATO: <span id="tomatoCount" class="font-mono">0</span></span><span class="badge badge-blue flex items-center gap-1">ğŸ‘¤ Leads: <span id="leadsCount" class="font-mono">0</span></span><span class="badge badge-blue flex items-center gap-1">ğŸ“¢ Complaints: <span id="complaintsCount" class="font-mono">0</span></span><span class="badge badge-blue flex items-center gap-1">ğŸ”µ Code Blue: <span id="codeBlueCount" class="font-mono">0</span></span><span class="badge badge-red flex items-center gap-1">ğŸ”´ Code Red: <span id="codeRedCount" class="font-mono">0</span></span></div><div class="ml-auto flex items-center gap-2 text-[0.65rem] text-slate-400"><span class="inline-flex items-center gap-1"><i class="fa-solid fa-arrows-rotate text-emerald-400"></i> Auto-refresh: 5 min</span></div></div><div class="glass-panel p-4"><div class="flex items-center justify-between mb-3"><div class="flex items-center gap-3"><h2 class="text-sm font-semibold text-white">Wrike Tasks</h2><div class="flex gap-1 text-[0.7rem]"><button id="tabAll" class="px-2 py-1 rounded-full bg-emerald-500/20 text-emerald-100 border border-emerald-400/40 text-xs">All</button><button id="tabPeacock" class="px-2 py-1 rounded-full bg-slate-800/80 text-slate-200 border border-slate-600/60 text-xs">Peacock</button><button id="tabTomato" class="px-2 py-1 rounded-full bg-slate-800/80 text-slate-200 border border-slate-600/60 text-xs">Tomato</button></div></div><span class="badge badge-blue flex items-center gap-1 text-[0.7rem]"><i class="fa-brands fa-wrike"></i> Folder 4333116655</span></div><div id="wrikeTasks" class="space-y-2 max-h-64 overflow-y-auto scrollbar-thin text-sm"><div class="flex items-center justify-between px-3 py-2 bg-slate-900/60 rounded-lg border border-dashed border-slate-600/60"><div class="flex flex-col"><span class="text-slate-300 text-xs">Connect Wrike in Settings to view tasks</span><span class="text-[0.65rem] text-slate-500 mt-1">Uses your access token for read-only board snapshots.</span></div><button class="text-xs text-emerald-400 hover:text-emerald-300 underline" onclick="openSettingsAndFocus('wrike')">Open Settings</button></div></div></div></section><section class="space-y-6"><div class="glass-panel p-4"><div class="flex items-center justify-between mb-3"><h2 class="text-sm font-semibold text-white flex items-center gap-2"><i class="fa-solid fa-link text-emerald-400"></i> Quick Links</h2><span class="badge badge-blue">Shortcuts</span></div><div class="grid grid-cols-2 gap-3 text-sm"><button class="btn-secondary px-3 py-2 rounded-xl border border-slate-700 flex items-center gap-2 justify-center text-xs" onclick="openLink('https://www.wrike.com/open.htm?id=4333116655')"><i class="fa-brands fa-wrike text-emerald-400"></i><span>Wrike Project</span></button><button class="btn-secondary px-3 py-2 rounded-xl border border-slate-700 flex items-center gap-2 justify-center text-xs" onclick="openLink('https://calendar.google.com')"><i class="fa-regular fa-calendar text-sky-400"></i><span>Google Calendar</span></button><button class="btn-secondary px-3 py-2 rounded-xl border border-slate-700 flex items-center gap-2 justify-center text-xs" onclick="openLink('https://supabase.com')"><i class="fa-solid fa-database text-emerald-300"></i><span>Supabase</span></button><button class="btn-secondary px-3 py-2 rounded-xl border border-slate-700 flex items-center gap-2 justify-center text-xs" onclick="openLink('https://github.com/SoftwareHealthAndLife/doctors-pay-calculator')"><i class="fa-brands fa-github text-slate-200"></i><span>GitHub</span></button><button class="btn-secondary px-3 py-2 rounded-xl border border-slate-700 flex items-center gap-2 justify-center text-xs col-span-2" onclick="openLink('https://chat.google.com')"><i class="fa-brands fa-google text-lime-300"></i><span>Google Chat</span></button></div></div><div class="glass-panel p-4"><div class="flex items-center justify-between mb-3"><h2 class="text-sm font-semibold text-white flex items-center gap-2"><i class="fa-regular fa-calendar-days text-sky-400"></i> Upcoming Deadlines</h2><span class="badge badge-peacock">Next 7 days</span></div><div id="upcomingDeadlines" class="space-y-2 max-h-40 overflow-y-auto scrollbar-thin text-sm"><div class="flex items-center justify-between px-3 py-2 bg-slate-900/60 rounded-lg border border-dashed border-slate-600/60"><div class="flex flex-col"><span class="text-slate-300 text-xs">Connect Google Calendar to view events</span><span class="text-[0.65rem] text-slate-500 mt-1">Uses your Google Client ID; no server-side storage.</span></div><button class="text-xs text-emerald-400 hover:text-emerald-300 underline" onclick="connectCalendarFromPanel()">Connect</button></div></div></div><div class="glass-panel p-4"><div class="flex items-center justify-between mb-3"><h2 class="text-sm font-semibold text-white flex items-center gap-2"><i class="fa-solid fa-wave-square text-emerald-400"></i> Activity Feed</h2><span class="badge badge-blue">Last 24h</span></div><div id="activityFeed" class="space-y-2 max-h-52 overflow-y-auto scrollbar-thin text-xs"><div class="flex items-center gap-3"><span class="activity-pill bg-slate-900/80 border border-slate-700/70 text-slate-300"><i class="fa-solid fa-circle-info text-sky-400"></i> Dashboard initialised</span><span class="text-[0.6rem] text-slate-500">Just now</span></div></div></div></section></main><div id="settingsModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-40 hidden"><div class="glass-panel w-full max-w-xl p-5 relative"><button class="absolute top-3 right-3 text-slate-500 hover:text-slate-300" onclick="toggleSettings(false)"><i class="fa-solid fa-xmark"></i></button><h2 class="text-lg font-semibold text-white mb-1 flex items-center gap-2"><i class="fa-solid fa-gear text-emerald-400"></i> Settings</h2><p class="text-xs text-slate-400 mb-4">Stored locally in your browser only. No credentials are sent to any server other than the services you configure.</p><div class="space-y-4 text-sm"><div><label class="flex items-center justify-between text-xs font-semibold text-slate-300 mb-1"><span>ğŸ—„ï¸ Supabase Anon Key</span><button class="text-[0.65rem] text-emerald-400 hover:text-emerald-300 underline" onclick="openLink('https://supabase.com/dashboard/projects')">Get Key â†’</button></label><input id="supabaseAnonKey" type="password" class="w-full px-3 py-2 rounded-lg bg-slate-900 border border-slate-700 text-xs text-slate-100" placeholder="paste your anon public key"/></div><div><label class="flex items-center justify-between text-xs font-semibold text-slate-300 mb-1"><span>ğŸ“‹ Wrike Access Token</span><button class="text-[0.65rem] text-emerald-400 hover:text-emerald-300 underline" onclick="openLink('https://www.wrike.com/frontend/apps/index.html#/api')">Get Token â†’</button></label><input id="wrikeToken" type="password" class="w-full px-3 py-2 rounded-lg bg-slate-900 border border-slate-700 text-xs text-slate-100" placeholder="paste your permanent access token"/></div><div><label class="flex items-center justify-between text-xs font-semibold text-slate-300 mb-1"><span>ğŸ“… Google Client ID</span><button class="text-[0.65rem] text-emerald-400 hover:text-emerald-300 underline" onclick="openLink('https://console.cloud.google.com/apis/credentials')">Create â†’</button></label><input id="googleClientId" type="text" class="w-full px-3 py-2 rounded-lg bg-slate-900 border border-slate-700 text-xs text-slate-100" placeholder="your_client_id.apps.googleusercontent.com"/></div><div><label class="flex items-center justify-between text-xs font-semibold text-slate-300 mb-1"><span>ğŸ’¬ Google Chat Webhook</span><button class="text-[0.65rem] text-emerald-400 hover:text-emerald-300 underline" onclick="openLink('https://support.google.com/chat/answer/13393665')">Create â†’</button></label><input id="googleChatWebhook" type="text" class="w-full px-3 py-2 rounded-lg bg-slate-900 border border-slate-700 text-xs text-slate-100" placeholder="https://chat.googleapis.com/v1/spaces..."/></div></div><div class="mt-5 flex items-center justify-between"><button id="saveSettingsBtn" class="btn-primary px-4 py-2 rounded-xl text-xs font-semibold text-slate-900 shadow-lg inline-flex items-center gap-2"><i class="fa-solid fa-floppy-disk"></i> Save Settings</button><button id="connectGoogleBtn" class="btn-secondary px-3 py-2 rounded-xl text-xs font-semibold text-slate-100 border border-sky-500/60 inline-flex items-center gap-2"><i class="fa-solid fa-link"></i> Connect Google Calendar</button></div></div></div></div><script>const STORAGE_KEY="hl-workflow-settings-v1";const ACTIVITY_KEY="hl-workflow-activity-v1";let settings={supabaseAnonKey:"",wrikeToken:"",googleClientId:"",googleChatWebhook:""};function logActivity(message,icon="fa-circle-info",tone="info"){const now=new Date().toISOString();const newEntry={message,icon,tone,ts:now};let history=[];try{const raw=localStorage.getItem(ACTIVITY_KEY);if(raw)history=JSON.parse(raw);}catch{}history.unshift(newEntry);history=history.slice(0,50);localStorage.setItem(ACTIVITY_KEY,JSON.stringify(history));renderActivity(history);}function renderActivity(history){const container=document.getElementById("activityFeed");if(!container)return;container.innerHTML="";if(!history||!history.length){const div=document.createElement("div");div.className="text-[0.7rem] text-slate-500";div.textContent="No recent activity yet.";container.appendChild(div);return;}history.forEach((item)=>{const wrap=document.createElement("div");wrap.className="flex items-center gap-3 mb-1";const pill=document.createElement("span");pill.className="activity-pill border "+(item.tone==="error"?"bg-red-900/40 border-red-500/50 text-red-200":item.tone==="success"?"bg-emerald-900/40 border-emerald-500/50 text-emerald-200":"bg-slate-900/80 border-slate-700/70 text-slate-300");const iconEl=document.createElement("i");iconEl.className="fa-solid "+item.icon;const msg=document.createElement("span");msg.textContent=item.message;pill.appendChild(iconEl);pill.appendChild(msg);const time=document.createElement("span");time.className="text-[0.6rem] text-slate-500";try{time.textContent=dayjs(item.ts).fromNow?dayjs(item.ts).fromNow():new Date(item.ts).toLocaleTimeString();}catch{time.textContent=new Date(item.ts).toLocaleTimeString();}wrap.appendChild(pill);wrap.appendChild(time);container.appendChild(wrap);});}function loadSettings(){try{const raw=localStorage.getItem(STORAGE_KEY);if(raw){settings={...settings,...JSON.parse(raw)};}}catch{}document.getElementById("supabaseAnonKey").value=settings.supabaseAnonKey||"";document.getElementById("wrikeToken").value=settings.wrikeToken||"";document.getElementById("googleClientId").value=settings.googleClientId||"";document.getElementById("googleChatWebhook").value=settings.googleChatWebhook||"";}function saveSettings(){settings.supabaseAnonKey=document.getElementById("supabaseAnonKey").value.trim();settings.wrikeToken=document.getElementById("wrikeToken").value.trim();settings.googleClientId=document.getElementById("googleClientId").value.trim();settings.googleChatWebhook=document.getElementById("googleChatWebhook").value.trim();localStorage.setItem(STORAGE_KEY,JSON.stringify(settings));logActivity("Settings saved locally.","fa-floppy-disk","success");}function toggleSettings(open){const modal=document.getElementById("settingsModal");if(!modal)return;modal.classList.toggle("hidden",!open);}function openSettingsAndFocus(which){toggleSettings(true);setTimeout(()=>{if(which==="wrike"){document.getElementById("wrikeToken").focus();}else if(which==="supabase"){document.getElementById("supabaseAnonKey").focus();}else if(which==="google"){document.getElementById("googleClientId").focus();}},100);}function openLink(url){window.open(url,"_blank","noopener");}function setLastRefreshed(){const span=document.getElementById("last-refresh-time");if(!span)return;const now=new Date();span.textContent=now.toLocaleTimeString();}async function fetchWrikeTasks(){const el=document.getElementById("wrikeTasks");if(!el)return;if(!settings.wrikeToken){return;}el.innerHTML="";const demo=document.createElement("div");demo.className="px-3 py-2 rounded-lg bg-slate-900/70 border border-emerald-500/40 text-xs text-emerald-100";demo.textContent="Wrike token detected. Connect to real API in this function.";el.appendChild(demo);document.getElementById("activeTasks").textContent="3";document.getElementById("percentComplete").textContent="42%";document.getElementById("peacockCount").textContent="1";document.getElementById("tomatoCount").textContent="2";logActivity("Wrike tasks refreshed (demo).","fa-brands fa-wrike","success");}async function fetchCalendarEvents(){const el=document.getElementById("upcomingDeadlines");if(!el)return;if(!settings.googleClientId){return;}el.innerHTML="";const row=document.createElement("div");row.className="flex items-center justify-between px-3 py-2 bg-slate-900/70 rounded-lg border border-sky-500/40 text-xs";const left=document.createElement("div");left.className="flex flex-col";const title=document.createElement("span");title.className="text-slate-100";title.textContent="Demo event from Google Calendar";const meta=document.createElement("span");meta.className="text-[0.65rem] text-slate-400";meta.textContent="Tomorrow â€¢ 10:00â€“11:00";left.appendChild(title);left.appendChild(meta);const badge=document.createElement("span");badge.className="badge badge-peacock text-[0.65rem]";badge.textContent="Calendar";row.appendChild(left);row.appendChild(badge);el.appendChild(row);document.getElementById("upcomingEvents").textContent="1";logActivity("Calendar events refreshed (demo).","fa-regular fa-calendar","success");}function connectCalendarFromPanel(){toggleSettings(true);setTimeout(()=>document.getElementById("googleClientId").focus(),150);}function initGoogle(){}async function fullRefresh(){setLastRefreshed();await fetchWrikeTasks();await fetchCalendarEvents();}document.addEventListener("DOMContentLoaded",()=>{loadSettings();try{const raw=localStorage.getItem(ACTIVITY_KEY);if(raw)renderActivity(JSON.parse(raw));}catch{}document.getElementById("settingsBtn").addEventListener("click",()=>toggleSettings(true));document.getElementById("saveSettingsBtn").addEventListener("click",()=>saveSettings());document.getElementById("refreshBtn").addEventListener("click",()=>fullRefresh());document.getElementById("connectGoogleBtn").addEventListener("click",()=>connectCalendarFromPanel());document.getElementById("settingsModal").addEventListener("click",(e)=>{if(e.target.id==="settingsModal")toggleSettings(false);});fullRefresh();setInterval(fullRefresh,5*60*1000);});</script></body></html>
